//==============================================================================================================================================
//
// リザルトタイマーに関する処理
// Author : Atsumu Kuboichi
//
//==============================================================================================================================================

//===========================================================================================================
// ヘッダーインクルード
//===========================================================================================================
#include "resulttime.h"
#include "game.h"

//===========================================================================================================
// 静的メンバ変数初期化
//===========================================================================================================
int CResultTime::m_nDigit = 0;//桁数

//===========================================================================================================
// コンストラクタ
//===========================================================================================================
CResultTime::CResultTime() : CUI(),
	m_nIdx(m_nDigit)
{
	m_nDigit++;//桁数を加算
}

//===========================================================================================================
// デストラクタ
//===========================================================================================================
CResultTime::~CResultTime()
{
	m_nDigit--;//桁数を減算
}

//===========================================================================================================
// 初期化処理
//===========================================================================================================
HRESULT CResultTime::Init()
{
	//座標設定
	SetNumberPos(GetPos());

	//テクスチャ分割数
	SetDivisionTex_X(10);//横

	//エディット可能フラグ
	SetEditFlag(false);

	//ローカル変数宣言
	int nTimer = CGame::GetInstance()->GetResultScore().nGoalTime;//現在のタイマー
	int nMulti = 1;//各桁の倍数

	//インデックスに合わせて倍数を求める
	for (int nCntTime = 0; nCntTime < m_nIdx + 1; nCntTime++)
	{
		nMulti *= 10;
	}

	// 該当する桁の数字を求める
	int nPosTex = (nTimer % nMulti) / (nMulti / 10);

	//横のアニメーションパターンを設定
	SetPatternAnim_X(nPosTex);

	//基底クラス初期化処理
	if (FAILED(CUI::Init())) return E_FAIL;

	return S_OK;
}

//===========================================================================================================
// 終了処理
//===========================================================================================================
void CResultTime::Uninit()
{
	//基底クラス終了処理
	CUI::Uninit();
}

//===========================================================================================================
// 更新処理
//===========================================================================================================
void CResultTime::Update()
{
	//基底クラス更新処理
	CUI::Update();
}

//===========================================================================================================
// 描画処理
//===========================================================================================================
void CResultTime::Draw()
{
	//基底クラス描画処理
	CUI::Draw();
}

//===========================================================================================================
// 座標設定
//===========================================================================================================
void CResultTime::SetNumberPos(const D3DXVECTOR2& pos)
{
	//桁数に応じて左にずらす
	SetPos({ pos.x - m_nIdx * (GetSize().x), pos.y });
}
